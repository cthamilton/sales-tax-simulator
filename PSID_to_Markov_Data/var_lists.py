
# Define function to extract year and variable names from text string


def var_list_parse(string):
    split_by_year = string.split()
    split_year_name = [i.split("]") for i in split_by_year]
    name = [i[1] for i in split_year_name]
    preyear = [i[0] for i in split_year_name]
    year = [i.strip("[") for i in preyear]
    return year, name

# Bring in var lists strings

 #Drop Variables
# drop_vars = "ER30429	ER25001	ER30020	V14801	ER30313	ER60001	V6901	V20301	V3	ER30067	ER33401	ER34101	ER30399	ER53001	ER33201	V8201	V1	ER30246	ER30000	ER5001	V11101	ER34201	V8801	ER30001	V5701	V1801	ER36001	ER30606	ER30535	ER33501	ER33901	ER33601	ER13001	ER30160	ER30217	ER30463	ER17001	ER30570	V4301	V12501	V21601	ER30091	ER34301	ER33801	V1101	ER10001	V3001	V10001	ER42001	V5201	ER33301	V6301	ER30002	ER33701	V7501	ER30138	ER47301	ER30642	ER30498	V17701	ER34001	ER30373	V16301	ER30188	ER33101	V2401	V13701	ER30733	ER21001	ER30117	ER30806	ER30043	ER30283	ER30689	V3801	V3401	ER7001	ER2001	V441	V19001	ER30343"

# v3 not in latest data
drop_vars = "ER30429	ER25001	ER30020	V14801	ER30313	ER60001	V6901	V20301	ER30067	ER33401	ER34101	ER30399	ER53001	ER33201	V8201	V1	ER30246	ER30000	ER5001	V11101	ER34201	V8801	ER30001	V5701	V1801	ER36001	ER30606	ER30535	ER33501	ER33901	ER33601	ER13001	ER30160	ER30217	ER30463	ER17001	ER30570	V4301	V12501	V21601	ER30091	ER34301	ER33801	V1101	ER10001	V3001	V10001	ER42001	V5201	ER33301	V6301	ER30002	ER33701	V7501	ER30138	ER47301	ER30642	ER30498	V17701	ER34001	ER30373	V16301	ER30188	ER33101	V2401	V13701	ER30733	ER21001	ER30117	ER30806	ER30043	ER30283	ER30689	V3801	V3401	ER7001	ER2001	V441	V19001	ER30343"
drop_vars_parsed = drop_vars.split()

#Age variable
age = "[68]ER30004 [69]ER30023 [70]ER30046 [71]ER30070 [72]ER30094 [73]ER30120 [74]ER30141 [75]ER30163 [76]ER30191 [77]ER30220 [78]ER30249 [79]ER30286 [80]ER30316 [81]ER30346 [82]ER30376 [83]ER30402 [84]ER30432 [85]ER30466 [86]ER30501 [87]ER30538 [88]ER30573 [89]ER30609 [90]ER30645 [91]ER30692 [92]ER30736 [93]ER30809 [94]ER33104 [95]ER33204 [96]ER33304 [97]ER33404 [99]ER33504 [01]ER33604 [03]ER33704 [05]ER33804 [07]ER33904 [09]ER34004 [11]ER34104 [13]ER34204 [15]ER34305 [17]ER34504"
yr_born = "[83]ER30404 [84]ER30434 [85]ER30468 [86]ER30503 [87]ER30540 [88]ER30575 [89]ER30611 [90]ER30647 [91]ER30694 [92]ER30738 [93]ER30811 [94]ER33106 [95]ER33206 [96]ER33306 [97]ER33406 [99]ER33506 [01]ER33606 [03]ER33706 [05]ER33806 [07]ER33906 [09]ER34006 [11]ER34106 [13]ER34206 [15]ER34307 [17]ER34506"

# Family Variables
relation_to_head = "[68]ER30003 [69]ER30022 [70]ER30045 [71]ER30069 [72]ER30093 [73]ER30119 [74]ER30140 [75]ER30162 [76]ER30190 [77]ER30219 [78]ER30248 [79]ER30285 [80]ER30315 [81]ER30345 [82]ER30375 [83]ER30401 [84]ER30431 [85]ER30465 [86]ER30500 [87]ER30537 [88]ER30572 [89]ER30608 [90]ER30644 [91]ER30691 [92]ER30735 [93]ER30808 [94]ER33103 [95]ER33203 [96]ER33303 [97]ER33403 [99]ER33503 [01]ER33603 [03]ER33703 [05]ER33803 [07]ER33903 [09]ER34003 [11]ER34103 [13]ER34203 [15]ER34303 [17]ER34503"
change_in_fam_comp = "[69]V542 [70]V1109 [71]V1809 [72]V2410 [73]V3010 [74]V3410 [75]V3810 [76]V4310 [77]V5210 [78]V5710 [79]V6310 [80]V6910 [81]V7510 [82]V8210 [83]V8810 [84]V10010 [85]V11112 [86]V12510 [87]V13710 [88]V14810 [89]V16310 [90]V17710 [91]V19010 [92]V20310 [93]V21608 [94]ER2005A [95]ER5004A [96]ER7004A [97]ER10004A [99]ER13008A [01]ER17007 [03]ER21007 [05]ER25007 [07]ER36007 [09]ER42007 [11]ER47307 [13]ER53007 [15]ER60007 [17]ER66007"
sequence_number = "[69]ER30021 [70]ER30044 [71]ER30068 [72]ER30092 [73]ER30118 [74]ER30139 [75]ER30161 [76]ER30189 [77]ER30218 [78]ER30247 [79]ER30284 [80]ER30314 [81]ER30344 [82]ER30374 [83]ER30400 [84]ER30430 [85]ER30464 [86]ER30499 [87]ER30536 [88]ER30571 [89]ER30607 [90]ER30643 [91]ER30690 [92]ER30734 [93]ER30807 [94]ER33102 [95]ER33202 [96]ER33302 [97]ER33402 [99]ER33502 [01]ER33602 [03]ER33702 [05]ER33802 [07]ER33902 [09]ER34002 [11]ER34102 [13]ER34202 [15]ER34302 [17]ER34502"

# Sample weights
weights_68_92 = "[68]V439 [69]V1014 [70]V1609 [71]V2321 [72]V2968 [73]V3301 [74]V3721 [75]V4224 [76]V5099 [77]V5665 [78]V6212 [79]V6805 [80]V7451 [81]V8103 [82]V8727 [83]V9433 [84]V11079 [85]V12446 [86]V13687 [87]V14737 [88]V16208 [89]V17612 [90]V18943 [91]V20243 [92]V21547"
weights_93_96 = "[93]V23361 [94]ER4160 [95]ER7000 [96]ER9251"
weights_97_15 = "[97]ER12084 [99]ER16518 [01]ER20394 [03]ER24179 [05]ER28078 [07]ER41069 [09]ER47012 [11]ER52436 [13]ER58257 [15]ER65492 [17]ER71570"

# Income variables
# Labor
total_labor_head = "[68]V74 [69]V514 [70]V1196 [71]V1897 [72]V2498 [73]V3051 [74]V3463 [75]V3863 [76]V5031 [77]V5627 [78]V6174 [79]V6767 [80]V7413 [81]V8066 [82]V8690 [83]V9376 [84]V11023 [85]V12372 [86]V13624 [87]V14671 [88]V16145 [89]V17534 [90]V18878 [91]V20178 [92]V21484 [93]V23323 [94]ER4140 [95]ER6980 [96]ER9231 [97]ER12080 [99]ER16463 [01]ER20443 [03]ER24116 [05]ER27931 [07]ER40921 [09]ER46829 [11]ER52237 [13]ER58038 [15]ER65216 [17]ER71293"
total_labor_spouse_68_93 = "[68]V75 [69]V516 [70]V1198 [71]V1899 [72]V2500 [73]V3053 [74]V3465 [75]V3865 [76]V4379 [77]V5289 [78]V5788 [79]V6398 [80]V6988 [81]V7580 [82]V8273 [83]V8881 [84]V10263 [85]V11404 [86]V12803 [87]V13905 [88]V14920 [89]V16420 [90]V17836 [91]V19136 [92]V20436 [93]V23324"
total_labor_spouse_94_15 = "[94]ER4144 [95]ER6984 [96]ER9235 [97]ER12082 [99]ER16465 [01]ER20447 [03]ER24135 [05]ER27943 [07]ER40933 [09]ER46841 [11]ER52249 [13]ER58050 [15]ER65244 [17]ER71321"
# Transfers
head_wife_transfers_70_15 = "[70]V1220 [71]V1922 [72]V2523 [73]V3076 [74]V3488 [75]V3889 [76]V4404 [77]V5316 [78]V5815 [79]V6426 [80]V7016 [81]V7608 [82]V8301 [83]V8909 [84]V10305 [85]V11461 [86]V12868 [87]V13970 [88]V14985 [89]V16485 [90]V17901 [91]V19201 [92]V20501 [93]V22366 [94]ER4147 [95]ER6987 [96]ER9238 [97]ER12071 [99]ER16454 [01]ER20450 [03]ER24101 [05]ER28002 [07]ER40992 [09]ER46900 [11]ER52308 [13]ER58117 [15]ER65314 [17]ER71391"
# Farm and Unincorporated businesses adjustment
uninc_business_inc_94_15 = "[94]ER4114 [95]ER6954 [96]ER9205 [97]ER12067 [99]ER16450 [01]ER20417 [03]ER24107 [05]ER27905 [07]ER40895 [09]ER46803 [11]ER52211 [13]ER58012 [15]ER65192 [17]ER71269"
farm_inc_94_15 = "[94]ER4117 [95]ER6957 [96]ER9208 [97]ER12065 [99]ER16448 [01]ER20420 [03]ER24105 [05]ER27908 [07]ER40898 [09]ER46806 [11]ER52214 [13]ER58015 [15]ER65195 [17]ER71272"

var_full = [age,yr_born,relation_to_head, change_in_fam_comp, sequence_number, weights_68_92, weights_93_96, weights_97_15, total_labor_head,
            total_labor_spouse_68_93, total_labor_spouse_94_15, head_wife_transfers_70_15, uninc_business_inc_94_15, farm_inc_94_15]

var_full_parsed = [list(var_list_parse(i)) for i in var_full]

var_full_names = ["age","yr_born","relation_to_head", "change_in_fam_comp", "sequence_number", "weights_68_92", "weights_93_96", "weights_97_15", "total_labor_head", "total_labor_spouse_68_93", "total_labor_spouse_94_15", "head_wife_transfers_70_15", "uninc_business_inc_94_15", "farm_inc_94_15"]


# print(var_full_parsed)


# [relation_to_head_vals, change_in_fam_comp_vals, weights_68_92_vals, weights_93_96_vals, weights_97_15_vals, total_labor_head_vals, total_labor_spouse_68_93_vals, total_labor_spouse_94_15_vals, head_wife_transfers_70_15_vals, uninc_business_inc_94_15_vals,
#     farm_inc_94_15_vals] = [relation_to_head, change_in_fam_comp, weights_68_92, weights_93_96, weights_97_15, total_labor_head, total_labor_spouse_68_93, total_labor_spouse_94_15, head_wife_transfers_70_15, uninc_business_inc_94_15, farm_inc_94_15]
# [relation_to_head_year, change_in_fam_comp_year, weights_68_92_year, weights_93_96_year, weights_97_15_year, total_labor_head_year, total_labor_spouse_68_93_year, total_labor_spouse_94_15_year, head_wife_transfers_70_15_year, uninc_business_inc_94_15_year,
#     farm_inc_94_15_year] = [relation_to_head, change_in_fam_comp, weights_68_92, weights_93_96, weights_97_15, total_labor_head, total_labor_spouse_68_93, total_labor_spouse_94_15, head_wife_transfers_70_15, uninc_business_inc_94_15, farm_inc_94_15]
#
#
# var_full_years = [relation_to_head_year, change_in_fam_comp_year, weights_68_92_year, weights_93_96_year, weights_97_15_year, total_labor_head_year,
#                   total_labor_spouse_68_93_year, total_labor_spouse_94_15_year, head_wife_transfers_70_15_year, uninc_business_inc_94_15_year, farm_inc_94_15_year]
#
# var_full_vals = [relation_to_head_vals, change_in_fam_comp_vals, weights_68_92_vals, weights_93_96_vals, weights_97_15_vals, total_labor_head_vals,
#                  total_labor_spouse_68_93_vals, total_labor_spouse_94_15_vals, head_wife_transfers_70_15_vals, uninc_business_inc_94_15_vals, farm_inc_94_15_vals]
#
